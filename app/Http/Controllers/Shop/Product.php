<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp6a5e99) { $sp0e6d39 = (int) $sp6a5e99->post('category_id'); if (!$sp0e6d39) { return Response::forbidden('请选择商品分类'); } $sp6643b9 = \App\Category::where('id', $sp0e6d39)->first(); if (!$sp6643b9) { return Response::forbidden('商品分类未找到'); } if ($sp6643b9->password_open && $sp6a5e99->post('password') !== $sp6643b9->password) { return Response::fail('分类密码输入错误'); } $sp395729 = \App\Product::where('category_id', $sp0e6d39)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp395729 as $spdbee16) { $spdbee16->setForShop(); } return Response::success($sp395729); } function verifyPassword(Request $sp6a5e99) { $spcf7e6d = (int) $sp6a5e99->post('product_id'); if (!$spcf7e6d) { return Response::forbidden('请选择商品'); } $spdbee16 = \App\Product::where('id', $spcf7e6d)->first(); if (!$spdbee16) { return Response::forbidden('商品未找到'); } if ($spdbee16->password_open && $sp6a5e99->post('password') !== $spdbee16->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }