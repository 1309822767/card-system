<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spc6bf93) { $this->geetest_conf = $spc6bf93; } public static function get() { $sp6fd351 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp7652a3 = time() . rand(1, 10000); $sp73477e = $sp6fd351->pre_process($sp7652a3); $sp567373 = json_decode($sp6fd351->get_response_str()); Session::put('gt_server', $sp73477e); Session::put('gt_user_id', $sp7652a3); return $sp567373; } public static function verify($sp255db5, $spc10b22, $sp7d7dd0) { $sp6fd351 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp7652a3 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spe62cd8 = $sp6fd351->success_validate($sp255db5, $spc10b22, $sp7d7dd0, $sp7652a3); if ($spe62cd8) { return true; } else { return false; } } else { if ($sp6fd351->fail_validate($sp255db5, $spc10b22, $sp7d7dd0)) { return true; } else { return false; } } } }