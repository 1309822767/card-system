<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spc8c9ef) { $this->geetest_conf = $spc8c9ef; } public static function get() { $sp5d3f49 = config('services.geetest.id'); $sp1e4b49 = config('services.geetest.key'); if (!strlen($sp5d3f49) || !strlen($sp1e4b49)) { return null; } $spdc5888 = new Lib($sp5d3f49, $sp1e4b49); $sp9f2e5e = time() . rand(1, 10000); $spf9795c = $spdc5888->pre_process($sp9f2e5e); $sp6f1294 = json_decode($spdc5888->get_response_str()); Session::put('gt_server', $spf9795c); Session::put('gt_user_id', $sp9f2e5e); return $sp6f1294; } public static function verify($sp1fdddf, $sp6b30ec, $sp2d5307) { $spdc5888 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $sp9f2e5e = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp820aff = $spdc5888->success_validate($sp1fdddf, $sp6b30ec, $sp2d5307, $sp9f2e5e); if ($sp820aff) { return true; } else { return false; } } else { if ($spdc5888->fail_validate($sp1fdddf, $sp6b30ec, $sp2d5307)) { return true; } else { return false; } } } }