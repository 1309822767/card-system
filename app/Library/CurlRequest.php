<?php
namespace App\Library; class CurlRequest { private static function curl($sp59c732, $sp48df7c = 0, $sp79a6d8 = '', &$sp74b8e5 = '', $sp43c518 = array(), $spafc194 = 5) { if (!isset($sp43c518['Accept'])) { $sp43c518['Accept'] = '*/*'; } if (!isset($sp43c518['Referer'])) { $sp43c518['Referer'] = $sp59c732; } if (!isset($sp43c518['Content-Type'])) { $sp43c518['Content-Type'] = 'application/x-www-form-urlencoded'; } if (!isset($sp43c518['User-Agent'])) { $sp43c518['User-Agent'] = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36'; } if ($sp74b8e5 != '') { $sp43c518['Cookie'] = $sp74b8e5; } $sp852727 = array(); foreach ($sp43c518 as $spee3819 => $sp53e898) { $sp852727[] = $spee3819 . ': ' . $sp53e898; } $sp852727[] = 'Expect:'; $sp72f257 = curl_init(); curl_setopt($sp72f257, CURLOPT_URL, $sp59c732); if ($sp48df7c == 1) { curl_setopt($sp72f257, CURLOPT_POST, 1); if ($sp79a6d8 != '') { curl_setopt($sp72f257, CURLOPT_POSTFIELDS, $sp79a6d8); } } if (defined('MY_PROXY')) { curl_setopt($sp72f257, CURLOPT_PROXY, MY_PROXY); } if (defined('MY_PROXY_PASS')) { curl_setopt($sp72f257, CURLOPT_PROXYUSERPWD, MY_PROXY_PASS); } curl_setopt($sp72f257, CURLOPT_TIMEOUT, $spafc194); curl_setopt($sp72f257, CURLOPT_CONNECTTIMEOUT, $spafc194); curl_setopt($sp72f257, CURLOPT_RETURNTRANSFER, 1); curl_setopt($sp72f257, CURLOPT_HEADER, 1); curl_setopt($sp72f257, CURLOPT_HTTPHEADER, $sp852727); $sp31c557 = curl_exec($sp72f257); $sp816c80 = curl_getinfo($sp72f257, CURLINFO_HEADER_SIZE); $spb8d34f = substr($sp31c557, 0, $sp816c80); $sp9a31c1 = substr($sp31c557, $sp816c80); curl_close($sp72f257); $sp43c518 = explode('
', $spb8d34f); $sp0b6ed4 = ''; foreach ($sp43c518 as $spb8d34f) { if (strpos($spb8d34f, 'Set-Cookie') !== false) { if (strpos($spb8d34f, ';') !== false) { $sp0b6ed4 = $sp0b6ed4 . trim(Helper::str_between($spb8d34f, 'Set-Cookie:', ';')) . ';'; } else { $sp0b6ed4 = $sp0b6ed4 . trim(str_replace('Set-Cookie:', '', $spb8d34f)) . ';'; } } } $sp74b8e5 = self::combineCookie($sp74b8e5, $sp0b6ed4); return $sp9a31c1; } public static function get($sp59c732, &$sp74b8e5 = '', $sp43c518 = array(), $spafc194 = 5) { return self::curl($sp59c732, 0, '', $sp74b8e5, $sp43c518, $spafc194); } public static function post($sp59c732, $sp79a6d8 = '', &$sp74b8e5 = '', $sp43c518 = array(), $spafc194 = 5) { return self::curl($sp59c732, 1, $sp79a6d8, $sp74b8e5, $sp43c518, $spafc194); } public static function combineCookie($spc5dd0c, $sp437bd6) { $sp97fad0 = explode(';', $spc5dd0c); $sp61fe67 = explode(';', $sp437bd6); foreach ($sp97fad0 as $spf5239b) { if (self::cookieIsExists($sp61fe67, self::cookieGetName($spf5239b)) == false) { array_push($sp61fe67, $spf5239b); } } $spb25d93 = ''; foreach ($sp61fe67 as $spf5239b) { if (substr($spf5239b, -8, 8) != '=deleted' && strlen($spf5239b) > 1) { $spb25d93 .= $spf5239b . '; '; } } return substr($spb25d93, 0, strlen($spb25d93) - 2); } public static function cookieGetName($sp72bdc4) { $sp014b81 = strpos($sp72bdc4, '='); return substr($sp72bdc4, 0, $sp014b81); } public static function cookieGetValue($sp72bdc4) { $sp014b81 = strpos($sp72bdc4, '='); $sp2d97c0 = substr($sp72bdc4, $sp014b81 + 1, strlen($sp72bdc4) - $sp014b81); return $sp2d97c0; } public static function cookieGet($sp74b8e5, $sp535158, $sp0713d6 = false) { $sp74b8e5 = str_replace(' ', '', $sp74b8e5); if (substr($sp74b8e5, -1, 1) != ';') { $sp74b8e5 = ';' . $sp74b8e5 . ';'; } else { $sp74b8e5 = ';' . $sp74b8e5; } $spd26ada = Helper::str_between($sp74b8e5, ';' . $sp535158 . '=', ';'); if (!$sp0713d6 || $spd26ada == '') { return $spd26ada; } else { return $sp535158 . '=' . $spd26ada; } } private static function cookieIsExists($spa1ae6e, $spccc325) { foreach ($spa1ae6e as $spf5239b) { if (self::cookieGetName($spf5239b) == $spccc325) { return true; } } return false; } function test() { $sp2d97c0 = self::combineCookie('a=1;b=2;c=3', 'c=5'); var_dump($sp2d97c0); } }