<?php
require_once 'alipay_core.function.php'; class AlipaySubmit { var $alipay_config; var $alipay_gateway_new = 'https://mapi.alipay.com/gateway.do?'; function __construct($sp2db4f5) { $this->alipay_config = $sp2db4f5; } function AlipaySubmit($sp2db4f5) { $this->__construct($sp2db4f5); } function buildRequestMysign($spe596a5) { $sp350c49 = createLinkString($spe596a5); switch (strtoupper(trim($this->alipay_config['sign_type']))) { case 'MD5': $sp922f2b = md5Sign($sp350c49, $this->alipay_config['key']); break; default: $sp922f2b = ''; } return $sp922f2b; } function buildRequestPara($spd86662) { $sp60c4f8 = paraFilter($spd86662); $spe596a5 = argSort($sp60c4f8); $sp922f2b = $this->buildRequestMysign($spe596a5); $spe596a5['sign'] = $sp922f2b; $spe596a5['sign_type'] = strtoupper(trim($this->alipay_config['sign_type'])); return $spe596a5; } function buildRequestParaToString($spd86662) { $sp11e254 = $this->buildRequestPara($spd86662); $sp71ced8 = createLinkStringUrlEncode($sp11e254); return $sp71ced8; } function buildRequestForm($spd86662, $sp48df7c, $spbd7a42) { $sp11e254 = $this->buildRequestPara($spd86662); $spb25f02 = '<form id=\'alipaysubmit\' name=\'alipaysubmit\' action=\'' . $this->alipay_gateway_new . '_input_charset=' . trim(strtolower($this->alipay_config['input_charset'])) . '\' method=\'' . $sp48df7c . '\'>'; foreach ($sp11e254 as $sp1e4b49 => $sp7a0550) { $spb25f02 .= '<input type=\'hidden\' name=\'' . $sp1e4b49 . '\' value=\'' . $sp7a0550 . '\'/>'; } $spb25f02 = $spb25f02 . '<input type=\'submit\'  value=\'' . $spbd7a42 . '\' style=\'display:none;\'></form>'; $spb25f02 = $spb25f02 . '<script>document.forms[\'alipaysubmit\'].submit();</script>'; return $spb25f02; } function query_timestamp() { $sp59c732 = $this->alipay_gateway_new . 'service=query_timestamp&partner=' . trim(strtolower($this->alipay_config['partner'])) . '&_input_charset=' . trim(strtolower($this->alipay_config['input_charset'])); $spf1f793 = new DOMDocument(); $spf1f793->load($sp59c732); $sp0ae64f = $spf1f793->getElementsByTagName('encrypt_key'); $spf5a281 = $sp0ae64f->item(0)->nodeValue; return $spf5a281; } }