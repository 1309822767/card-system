<?php
interface ILogHandler { public function write($spb18c75); } class CLogFileHandler implements ILogHandler { private $handle = null; public function __construct($sp90b6b6 = '') { $this->handle = fopen($sp90b6b6, 'a'); } public function write($spb18c75) { fwrite($this->handle, $spb18c75, 4096); } public function __destruct() { fclose($this->handle); } } class Log { private $handler = null; private $level = 15; private static $instance = null; private function __construct() { } private function __clone() { } public static function Init($sp2e6926 = null, $sp8a0843 = 15) { if (!self::$instance instanceof self) { self::$instance = new self(); self::$instance->__setHandle($sp2e6926); self::$instance->__setLevel($sp8a0843); } return self::$instance; } private function __setHandle($sp2e6926) { $this->handler = $sp2e6926; } private function __setLevel($sp8a0843) { $this->level = $sp8a0843; } public static function DEBUG($spb18c75) { self::$instance->write(1, $spb18c75); } public static function WARN($spb18c75) { self::$instance->write(4, $spb18c75); } public static function ERROR($spb18c75) { $sp4f01fe = debug_backtrace(); $spe900b6 = '['; foreach ($sp4f01fe as $spc37b44 => $spfca62c) { if (array_key_exists('file', $spfca62c)) { $spe900b6 .= ',file:' . $spfca62c['file']; } if (array_key_exists('line', $spfca62c)) { $spe900b6 .= ',line:' . $spfca62c['line']; } if (array_key_exists('function', $spfca62c)) { $spe900b6 .= ',function:' . $spfca62c['function']; } } $spe900b6 .= ']'; self::$instance->write(8, $spe900b6 . $spb18c75); } public static function INFO($spb18c75) { self::$instance->write(2, $spb18c75); } private function getLevelStr($sp8a0843) { switch ($sp8a0843) { case 1: return 'debug'; break; case 2: return 'info'; break; case 4: return 'warn'; break; case 8: return 'error'; break; default: } } protected function write($sp8a0843, $spb18c75) { if (($sp8a0843 & $this->level) == $sp8a0843) { $spb18c75 = '[' . date('Y-m-d H:i:s') . '][' . $this->getLevelStr($sp8a0843) . '] ' . $spb18c75 . '
'; $this->handler->write($spb18c75); } } }