<?php
function aliqr_encrypt($sp4e169a, $sp378b7f) { $sp378b7f = base64_decode($sp378b7f); $sp4e169a = trim($sp4e169a); $sp4e169a = addPKCS7Padding($sp4e169a); $sp735c57 = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp9c9c7a = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $sp378b7f, $sp4e169a, MCRYPT_MODE_CBC); return base64_encode($sp9c9c7a); } function aliqr_decrypt($sp4e169a, $sp378b7f) { $sp4e169a = base64_decode($sp4e169a); $sp378b7f = base64_decode($sp378b7f); $sp735c57 = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp9c9c7a = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $sp378b7f, $sp4e169a, MCRYPT_MODE_CBC); $sp9c9c7a = trim($sp9c9c7a); $sp9c9c7a = stripPKSC7Padding($sp9c9c7a); return $sp9c9c7a; } function addPKCS7Padding($sp50924b) { $sp50924b = trim($sp50924b); $spdb06cb = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); $sp85e30d = $spdb06cb - strlen($sp50924b) % $spdb06cb; if ($sp85e30d <= $spdb06cb) { $spdb558d = chr($sp85e30d); $sp50924b .= str_repeat($spdb558d, $sp85e30d); } return $sp50924b; } function stripPKSC7Padding($sp50924b) { $sp50924b = trim($sp50924b); $spdb558d = substr($sp50924b, -1); $spc277ed = ord($spdb558d); if ($spc277ed == 62) { return $sp50924b; } $sp50924b = substr($sp50924b, 0, -$spc277ed); return $sp50924b; }