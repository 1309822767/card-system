<?php
namespace App\Library\Pay\Fakala; use App\Library\Pay\ApiInterface; class Api implements ApiInterface { private $url_notify = ''; private $url_return = ''; private $pay_id; public function __construct($sp5d3f49) { $this->url_notify = SYS_URL_API . '/pay/notify/' . $sp5d3f49; $this->url_return = SYS_URL . '/pay/return/' . $sp5d3f49; $this->pay_id = $sp5d3f49; } function goPay($spc8c9ef, $sp4510be, $sp930bb6, $sp9a31c1, $spfa6477) { if (!isset($spc8c9ef['gateway'])) { throw new \Exception('请填写gateway'); } if (!isset($spc8c9ef['api_id'])) { throw new \Exception('请填写api_id'); } if (!isset($spc8c9ef['api_key'])) { throw new \Exception('请填写api_key'); } include_once 'sdk.php'; $spb82c7b = new \fakala($spc8c9ef['gateway'], $spc8c9ef['api_id'], $spc8c9ef['api_key']); $sp2688c6 = strtolower($spc8c9ef['payway']); $spb82c7b->goPay($sp2688c6, $sp930bb6, $sp4510be, 0, $spfa6477, '', $this->url_return, $this->url_notify); } function verify($spc8c9ef, $sp53cf01) { $sp412d81 = isset($spc8c9ef['isNotify']) && $spc8c9ef['isNotify']; include_once 'sdk.php'; $spb82c7b = new \fakala($spc8c9ef['gateway'], $spc8c9ef['api_id'], $spc8c9ef['api_key']); if ($sp412d81) { $sp820aff = $spb82c7b->notify_verify(); } else { $sp820aff = $spb82c7b->return_verify(); } if ($sp820aff) { $sp4510be = $_REQUEST['out_trade_no']; $sp6f1ff6 = $_REQUEST['total_fee']; $sp283841 = $_REQUEST['order_no']; $sp53cf01($sp4510be, $sp6f1ff6, $sp283841); } return $sp820aff; } }