<?php
require_once 'qpayMchUtil.class.php'; class QpayMchAPI { protected $url; protected $isSSL; protected $timeout; public function __construct($sp81923e, $sp98d19e, $sped125a = 5) { $this->url = $sp81923e; $this->isSSL = $sp98d19e; $this->timeout = $sped125a; } public function notify_params() { $sp60a70a = file_get_contents('php://input'); return QpayMchUtil::xmlToArray($sp60a70a); } public function notify_verify($sp342eea, $spc6bf93) { if (!isset($sp342eea['sign'])) { return false; } $spa0f4ca = QpayMchUtil::getSign($sp342eea, $spc6bf93['mch_key']); return $spa0f4ca === $sp342eea['sign']; } public function req($sp342eea, $spc6bf93) { $sp567373 = array(); $sp342eea['mch_id'] = $spc6bf93['mch_id']; $sp342eea['nonce_str'] = QpayMchUtil::createNoncestr(); $sp342eea['sign'] = QpayMchUtil::getSign($sp342eea, $spc6bf93['mch_key']); $sp60a70a = QpayMchUtil::arrayToXml($sp342eea); if (isset($this->isSSL)) { $sp567373 = QpayMchUtil::reqByCurlSSLPost($sp60a70a, $this->url, $this->timeout); } else { $sp567373 = QpayMchUtil::reqByCurlNormalPost($sp60a70a, $this->url, $this->timeout); } return $sp567373; } }