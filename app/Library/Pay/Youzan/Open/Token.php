<?php
namespace App\Library\Pay\Youzan\Open; use Exception; class Token { private $clientId; private $clientSecret; private $accessToken; private $refreshToken; private static $requestUrl = 'https://open.youzan.com/oauth/token'; public function __construct($sp6b7109, $sp288596, $sp86d993 = null, $spa46b0d = null) { $this->clientId = $sp6b7109; $this->clientSecret = $sp288596; $this->accessToken = $sp86d993; $this->refreshToken = $spa46b0d; } public function getToken($sp4c5fa8, $sp560b8c = array()) { $sp342eea = array(); $sp342eea['client_id'] = $this->clientId; $sp342eea['client_secret'] = $this->clientSecret; if ($sp4c5fa8 === 'oauth') { $sp342eea['grant_type'] = 'authorization_code'; $sp342eea['code'] = $sp560b8c['code']; $sp342eea['redirect_uri'] = $sp560b8c['redirect_uri']; } elseif ($sp4c5fa8 === 'refresh_token') { $sp342eea['grant_type'] = 'refresh_token'; $sp342eea['refresh_token'] = $sp560b8c['refresh_token']; } elseif ($sp4c5fa8 === 'self') { $sp342eea['grant_type'] = 'silent'; $sp342eea['kdt_id'] = $sp560b8c['kdt_id']; } elseif ($sp4c5fa8 === 'platform_init') { $sp342eea['grant_type'] = 'authorize_platform'; } elseif ($sp4c5fa8 === 'platform') { $sp342eea['grant_type'] = 'authorize_platform'; $sp342eea['kdt_id'] = $sp560b8c['kdt_id']; } return $this->parseResponse(Http::post(self::$requestUrl, $sp342eea)); } private function parseResponse($sp631cf0) { $spbda5b4 = json_decode($sp631cf0, true); if (null === $spbda5b4) { throw new Exception('response invalid, data: ' . $sp631cf0); } return $spbda5b4; } }